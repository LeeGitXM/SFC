#!/bin/sh
# Copy XML export files from svn into our project
# for viewing in Eclipse. Clean out irrelevant directories.
# Vistalon and Halobutyl have been vetted (hand-worked) and
# checked into SVN. For these we don't bother with the 
# raw migrations
#
SVNESCRAW="${SVN_REPO}/EMChemicals/Migration/Escorez/Exports From G2/SequentialControl"
SVNGLINERAW="${SVN_REPO}/EMChemicals/Migration/G-Line/Exports From G2/SequentialControl"
SVNHBRAW="${SVN_REPO}/EMChemicals/Migration/Halobutyl/Exports From G2/Sequential Control"
SVNHB="${SVN_REPO}/EMChemicals/Migration/Halobutyl/SFCs/Vetted"
SVNVISTRAW="${SVN_REPO}/EMChemicals/Migration/Vistalon/Exports From G2/SequentialControl"
SVNVIST="${SVN_REPO}/EMChemicals/Migration/Vistalon/SFCs/Vetted"
XML=${GIT_REPO}/sfc/migration/xml
rm -rf $XML/vetted
mkdir -p $XML/g2/escorez
mkdir -p $XML/g2/gline
mkdir -p $XML/g2/halobutyl
mkdir -p $XML/g2/vistalon
mkdir -p $XML/ignition/escorez
mkdir -p $XML/ignition/halobutyl
mkdir -p $XML/ignition/vistalon
mkdir -p $XML/vetted/halobutyl
mkdir -p $XML/vetted/vistalon
cd "${SVNESCRAW}"
for dir in *
do
   if [ -d $dir ]
   then
      cd $dir
      echo `pwd`
      mkdir -p $XML/g2/escorez/$dir
	  cd XML
      cp -a * $XML/g2/escorez/$dir
      cd "${SVNESCRAW}"
   fi
done
cd "${SVNGLINERAW}"
for dir in *
do
   if [ -d $dir ]
   then
      cd $dir
      echo `pwd`
      mkdir -p $XML/g2/gline/$dir
	  cd XML
      cp -a * $XML/g2/gline/$dir
      cd "${SVNGLINERAW}"
   fi
done
cd "${SVNHBRAW}"
for dir in *
do
   if [ -d $dir ]
   then
      cd $dir
      echo `pwd`
      mkdir -p $XML/g2/halobutyl/$dir
	  cd XML
      cp -a * $XML/g2/halobutyl/$dir
      cd "${SVNHBRAW}"
   fi
done
cd "${SVNHB}"
cp -a *.proj $XML/vetted/halobutyl

cd "${SVNVISTRAW}"
for dir in *
do
   if [ -d $dir ]
   then
      cd $dir
      echo `pwd`
      mkdir -p $XML/g2/vistalon/$dir
	  cd SFCs
      cp -a * $XML/g2/vistalon/$dir
      cd "${SVNVISTRAW}"
   fi
done
cd "${SVNVIST}"
cp -a *.proj $XML/vetted/vistalon

# Clean up the non-xml
find ${XML}/g2 -type f ! -name "*.xml" -exec rm {}  \; 
rm -rf `find ${XML}/g2 -type d -name Diagrams`  2&>/dev/null
rm -rf `find ${XML}/g2 -type d -name diagrams`  2&>/dev/null
rm -rf `find ${XML}/g2 -type d -name callbacks`  2&>/dev/null
rm `find ${XML}/g2 -type f -name "*.csv"`  2&>/dev/null
# Clean up unwanted charts
cd ${XML}
rm -rf g2/vistalon/VISTALON-UNIT-PROCEDURE/*OFFLINE-OPERATION
