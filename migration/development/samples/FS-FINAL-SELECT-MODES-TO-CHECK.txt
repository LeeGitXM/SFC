fs-final-select-modes-to-check 
(
   BLOCK: class s88-recipe-entity
) =
(
   symbol {complete, stopped, or error}
)
{Converts the polymer rate from the operator in klb/d to klb/hr for later use.}

P: class ph-procedure-or-method = this procedure;
DEBUG-MODE: truth-value = false;
UNIT-PROCEDURE: class s88-unit-procedure;
ERROR: class s88-error;
ERROR-TXT: text;
SEQ: sequence;

C9-USE, H2-USE, NH3-USE, ETOH-USE, OIL-USE: truth-value;
MODE-TEST: truth-value;

begin
	if the debug-mode of P or the debug-mode of BLOCK then DEBUG-MODE = true;
	if DEBUG-MODE then post "In [the name of P] with [the label of BLOCK], a [the class of BLOCK]. . .";

	conclude that the state of BLOCK = s88-running-state;
	UNIT-PROCEDURE = call s88-get-unit-procedure (BLOCK); 

	begin 
		C9-USE = 	call s88-get (BLOCK, "NEW.C9-USE-TAG.val", s88-superior-operation); 
		H2-USE = 	call s88-get (BLOCK, "NEW.H2-USE-TAG.val", s88-superior-operation);
		NH3-USE = 	call s88-get (BLOCK, "NEW.NH3-USE-TAG.val", s88-superior-operation);
		ETOH-USE = 	call s88-get (BLOCK, "NEW.ETOH-USE-TAG.val", s88-superior-operation);  
		OIL-USE = 	call s88-get (BLOCK, "NEW.OIL-USE-TAG.val", s88-superior-operation); 
	end
		on error (ERROR)
		delete ERROR;
		ERROR-TXT = "In [the name of P] - unable to collect component use data for controller mode tests.";
		call s88-post-message-to-queue(BLOCK, ERROR-TXT, em-critical, BLOCK); 
		start _s88-abort(UNIT-PROCEDURE);
		wait for 2 seconds;
		return s88-complete-state;
	end;

{Get the configuration of the check control mode block.  Note that this is a named block}
	SEQ = the configuration of fs-final-control-mode-single;

{------  C9 ------} 
	if C9-USE = false  then MODE-TEST =  false else MODE-TEST = true;
	SEQ = call ils-update-structure-in-a-keyed-sequence (SEQ, the symbol key, "new.r1-c9-to-c2-sp", the symbol check-path-to-valve, MODE-TEST); 

{------  H2  ------} 
	if  H2-USE = false then MODE-TEST =  false else MODE-TEST = true;
	SEQ = call ils-update-structure-in-a-keyed-sequence (SEQ, the symbol key, "new.r1-h2-to-va-sp", the symbol check-path-to-valve, MODE-TEST);

{------  NH3  ------} 
	if  NH3-USE = false then MODE-TEST =  false else MODE-TEST = true;
	SEQ = call ils-update-structure-in-a-keyed-sequence (SEQ, the symbol key, "new.r1-nh3-to-va-sp", the symbol check-path-to-valve, MODE-TEST);

 {------  ETOH  ------} 
	if  ETOH-USE = false then MODE-TEST =  false else MODE-TEST = true;
	SEQ = call ils-update-structure-in-a-keyed-sequence (SEQ, the symbol key, "new.r1-etoh-to-va-sp", the symbol check-path-to-valve, MODE-TEST); 

{------  OIL  ------} 
	if  OIL-USE = false then MODE-TEST =  false else MODE-TEST = true;
	SEQ = call ils-update-structure-in-a-keyed-sequence (SEQ, the symbol key, "new.oil-to-polymer-sp", the symbol check-path-to-valve, MODE-TEST);

{Replace the configuration sequence that has the updated prompts.}
	conclude that the configuration of fs-final-control-mode-single = SEQ; 
	if DEBUG-MODE then post "In [the name of P] with SEQ=[seq]";
	if DEBUG-MODE then post "In [the name of P] for [the label of BLOCK] has completed!";

	return s88-complete-state;
end 